<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>FAMILYNK â€” Cerebro</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Quicksand:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #5B8C85;
      --primary-light: #7BA9A3;
      --primary-dark: #4A7570;
      --secondary: #F2E8DC;
      --secondary-dark: #E8DBC8;
      --accent: #E8985E;
      --accent-light: #F0B088;
      --text: #3D3D3D;
      --text-light: #6B6B6B;
      --text-muted: #9A9A9A;
      --background: #FAFAFA;
      --white: #FFFFFF;
      --success: #7DB59A;
      --warning: #E8C547;
      --error: #E07B7B;
      --shadow-sm: 0 2px 8px rgba(0,0,0,0.06);
      --shadow-md: 0 4px 16px rgba(0,0,0,0.08);
      --shadow-lg: 0 8px 32px rgba(0,0,0,0.12);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Nunito', -apple-system, sans-serif;
      background: var(--background);
      color: var(--text);
      line-height: 1.5;
      min-height: 100vh;
    }

    /* === HEADER === */
    .header {
      background: var(--white);
      padding: 12px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-sm);
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      height: 60px;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo {
      font-family: 'Quicksand', sans-serif;
      font-weight: 700;
      font-size: 1.3rem;
      color: var(--primary);
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
    }

    .logo-icon {
      width: 32px;
      height: 32px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1rem;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .search-btn {
      background: var(--secondary);
      border: none;
      padding: 8px 14px;
      border-radius: var(--radius-lg);
      font-size: 0.85rem;
      color: var(--text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
    }

    .search-btn:hover { background: var(--secondary-dark); }

    .avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
    }

    /* === MAIN === */
    .main {
      padding: 20px;
      padding-top: 80px;
      padding-bottom: 100px;
      max-width: 600px;
      margin: 0 auto;
    }

    /* === PAGE HEADER === */
    .page-header {
      margin-bottom: 20px;
    }

    .page-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .page-subtitle {
      color: var(--text-light);
      font-size: 0.9rem;
      margin-top: 4px;
    }

    /* === ÃMBITOS SELECTOR === */
    .ambitos-section {
      margin-bottom: 24px;
    }

    .ambitos-scroll {
      display: flex;
      gap: 10px;
      overflow-x: auto;
      padding-bottom: 8px;
      scroll-snap-type: x mandatory;
      -webkit-overflow-scrolling: touch;
    }

    .ambitos-scroll::-webkit-scrollbar { display: none; }

    .ambito-card {
      flex-shrink: 0;
      width: 140px;
      padding: 16px 14px;
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-sm);
      cursor: pointer;
      transition: all 0.2s ease;
      scroll-snap-align: start;
      border: 2px solid transparent;
    }

    .ambito-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .ambito-card.active {
      border-color: var(--primary);
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
    }

    .ambito-icon {
      font-size: 1.8rem;
      margin-bottom: 8px;
    }

    .ambito-name {
      font-weight: 700;
      font-size: 0.9rem;
      margin-bottom: 2px;
    }

    .ambito-meta {
      font-size: 0.7rem;
      opacity: 0.7;
    }

    .ambito-card.active .ambito-meta { opacity: 0.9; }

    /* === SUGERENCIA SUTIL === */
    .hint-bubble {
      background: linear-gradient(135deg, #FDF8F0 0%, var(--secondary) 100%);
      border-radius: var(--radius-lg);
      padding: 14px 16px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 12px;
      border-left: 3px solid var(--accent);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .hint-bubble:hover {
      transform: translateX(4px);
    }

    .hint-icon {
      font-size: 1.4rem;
      flex-shrink: 0;
    }

    .hint-text {
      flex: 1;
      font-size: 0.85rem;
      color: var(--text);
    }

    .hint-dismiss {
      color: var(--text-muted);
      font-size: 1.2rem;
      cursor: pointer;
      padding: 4px;
    }

    .hint-dismiss:hover { color: var(--text); }

    /* === CARDS === */
    .card {
      background: var(--white);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin-bottom: 16px;
      box-shadow: var(--shadow-sm);
      transition: all 0.3s ease;
    }

    .card:hover { box-shadow: var(--shadow-md); }

    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
    }

    .card-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1rem;
      font-weight: 600;
      color: var(--text);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .card-title-icon {
      width: 28px;
      height: 28px;
      background: var(--secondary);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
    }

    .card-action {
      color: var(--primary);
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: color 0.2s ease;
    }

    .card-action:hover { color: var(--primary-dark); }

    /* === CATEGORY PILLS === */
    .category-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .pill {
      padding: 6px 14px;
      background: var(--secondary);
      border-radius: var(--radius-xl);
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--text-light);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .pill:hover { background: var(--secondary-dark); }

    .pill.active {
      background: var(--primary);
      color: white;
    }

    /* === INFO ITEMS === */
    .info-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .info-item {
      display: flex;
      align-items: center;
      gap: 14px;
      padding: 14px 16px;
      background: var(--secondary);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .info-item:hover {
      background: var(--secondary-dark);
      transform: translateX(4px);
    }

    .info-icon {
      width: 44px;
      height: 44px;
      background: var(--white);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
      flex-shrink: 0;
    }

    .info-content { flex: 1; }

    .info-title {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 2px;
    }

    .info-subtitle {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .info-badge {
      padding: 4px 10px;
      background: var(--primary-light);
      color: white;
      font-size: 0.65rem;
      font-weight: 700;
      border-radius: var(--radius-lg);
    }

    .info-arrow {
      color: var(--text-muted);
      font-size: 1.2rem;
    }

    /* === MEMBER CARDS === */
    .members-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .member-card {
      background: var(--secondary);
      border-radius: var(--radius-md);
      padding: 16px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .member-card:hover {
      background: var(--secondary-dark);
      transform: translateY(-2px);
    }

    .member-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
      font-weight: 700;
      margin: 0 auto 10px;
    }

    .member-name {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 2px;
    }

    .member-role {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .member-location {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      margin-top: 8px;
      padding: 4px 10px;
      background: var(--white);
      border-radius: var(--radius-lg);
      font-size: 0.7rem;
      color: var(--text-light);
    }

    /* === PROTOCOL CARDS === */
    .protocol-card {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 14px;
      background: var(--secondary);
      border-radius: var(--radius-md);
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .protocol-card:hover {
      background: var(--secondary-dark);
    }

    .protocol-icon {
      width: 40px;
      height: 40px;
      background: var(--white);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      flex-shrink: 0;
    }

    .protocol-content { flex: 1; }

    .protocol-title {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: 4px;
    }

    .protocol-meta {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .protocol-tags {
      display: flex;
      gap: 6px;
      margin-top: 8px;
    }

    .protocol-tag {
      padding: 2px 8px;
      background: var(--white);
      border-radius: var(--radius-sm);
      font-size: 0.65rem;
      color: var(--text-light);
    }

    /* === QUICK ACCESS GRID === */
    .quick-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }

    .quick-item {
      background: var(--secondary);
      border-radius: var(--radius-md);
      padding: 16px 10px;
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .quick-item:hover {
      background: var(--secondary-dark);
      transform: scale(1.02);
    }

    .quick-icon {
      font-size: 1.5rem;
      margin-bottom: 6px;
    }

    .quick-label {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text);
    }

    /* === SPACE DETAIL === */
    .space-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      border-radius: var(--radius-lg);
      padding: 24px 20px;
      color: white;
      margin-bottom: 20px;
    }

    .space-header-top {
      display: flex;
      align-items: center;
      gap: 14px;
      margin-bottom: 12px;
    }

    .space-header-icon {
      font-size: 2.5rem;
    }

    .space-header-info { flex: 1; }

    .space-header-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.4rem;
      font-weight: 700;
      margin-bottom: 2px;
    }

    .space-header-subtitle {
      font-size: 0.85rem;
      opacity: 0.9;
    }

    .space-stats {
      display: flex;
      gap: 20px;
      padding-top: 14px;
      border-top: 1px solid rgba(255,255,255,0.2);
    }

    .space-stat {
      text-align: center;
    }

    .space-stat-value {
      font-size: 1.2rem;
      font-weight: 700;
    }

    .space-stat-label {
      font-size: 0.7rem;
      opacity: 0.85;
    }

    /* === BACK BUTTON === */
    .back-btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--secondary);
      border: none;
      border-radius: var(--radius-lg);
      font-family: 'Nunito', sans-serif;
      font-size: 0.85rem;
      color: var(--text);
      cursor: pointer;
      margin-bottom: 16px;
      transition: all 0.2s ease;
    }

    .back-btn:hover { background: var(--secondary-dark); }

    /* === AGREGADO CARD (para vista General) === */
    .agregado-card {
      background: linear-gradient(135deg, var(--secondary) 0%, #FDF6EE 100%);
      border: 1px solid var(--secondary-dark);
      border-radius: var(--radius-lg);
      padding: 16px;
      margin-bottom: 12px;
    }

    .agregado-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 12px;
    }

    .agregado-title {
      font-weight: 600;
      font-size: 0.9rem;
    }

    .agregado-items {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .agregado-item {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: var(--white);
      border-radius: var(--radius-lg);
      font-size: 0.8rem;
    }

    .agregado-item-icon { font-size: 0.9rem; }

    /* === NAV BOTTOM === */
    .nav-bottom {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--white);
      box-shadow: 0 -4px 20px rgba(0,0,0,0.08);
      display: flex;
      justify-content: space-around;
      padding: 8px 12px;
      padding-bottom: max(8px, env(safe-area-inset-bottom));
      z-index: 100;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 3px;
      padding: 6px 12px;
      border-radius: var(--radius-md);
      color: var(--text-muted);
      transition: all 0.2s ease;
      cursor: pointer;
      border: none;
      background: none;
      font-family: 'Nunito', sans-serif;
    }

    .nav-item:hover { color: var(--primary); }

    .nav-item.active {
      color: var(--primary);
      background: var(--secondary);
    }

    .nav-icon { font-size: 1.3rem; }
    .nav-label { font-size: 0.65rem; font-weight: 600; }

    /* === FAB === */
    .fab {
      position: fixed;
      bottom: 85px;
      right: 20px;
      width: 54px;
      height: 54px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
      color: white;
      border: none;
      box-shadow: var(--shadow-lg);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.4rem;
      transition: all 0.3s ease;
      z-index: 50;
    }

    .fab:hover {
      transform: scale(1.08);
    }

    /* === ANIMATIONS === */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .page-content { animation: fadeIn 0.3s ease; }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-10px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .hint-bubble { animation: slideIn 0.4s ease 0.3s both; }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="header-left">
      <div class="logo">
        <div class="logo-icon">ğŸ </div>
        FAMILYNK
      </div>
    </div>
    <div class="header-right">
      <button class="search-btn">
        ğŸ” Buscar...
      </button>
      <div class="avatar">F</div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="main" id="mainContent"></main>

  <!-- FAB -->
  <button class="fab">+</button>

  <!-- NAV BOTTOM -->
  <nav class="nav-bottom">
    <button class="nav-item"><span class="nav-icon">ğŸ </span><span class="nav-label">Inicio</span></button>
    <button class="nav-item active"><span class="nav-icon">ğŸ“š</span><span class="nav-label">Cerebro</span></button>
    <button class="nav-item"><span class="nav-icon">âš¡</span><span class="nav-label">AcciÃ³n</span></button>
    <button class="nav-item"><span class="nav-icon">ğŸ’¬</span><span class="nav-label">Comuni.</span></button>
    <button class="nav-item"><span class="nav-icon">ğŸ“Š</span><span class="nav-label">Espejo</span></button>
  </nav>

  <script>
    let currentView = 'main';
    let currentAmbito = 'general';
    let currentProfile = 'padre';

    // Sugerencias adaptadas por perfil
    const hints = {
      padre: {
        icon: 'ğŸ’¡',
        text: '<strong>Hace tiempo</strong> que no actualizas el contacto del electricista de Casa B'
      },
      madre: {
        icon: 'ğŸ’¡',
        text: 'El seguro del hogar de Casa B <strong>vence en marzo</strong>. Por si quieres revisarlo.'
      },
      hijo22: {
        icon: 'ğŸ¤™',
        text: 'Â¿Por si te renta? Tu carnet de conducir <strong>caduca en 2026</strong>. Buen momento para renovarlo sin agobios.'
      },
      hijo16: {
        icon: 'ğŸ˜',
        text: 'Â¿Por si te renta? Tienes el <strong>cumple de la abuela</strong> en 5 dÃ­as. Igual mola tener algo pensado.'
      }
    };

    function changeProfile(profile) {
      currentProfile = profile;
      
      // Update pills
      document.querySelectorAll('.pill[id^="profile-"]').forEach(p => p.classList.remove('active'));
      document.getElementById('profile-' + profile).classList.add('active');
      
      // Update hint
      updateHint();
    }

    function updateHint() {
      const hint = hints[currentProfile];
      const hintText = document.getElementById('hintText');
      const hintIcon = document.querySelector('.hint-icon');
      if (hintText && hintIcon) {
        hintText.innerHTML = hint.text;
        hintIcon.textContent = hint.icon;
      }
    }

    const ambitos = {
      general: { name: 'General', icon: 'ğŸŒ', meta: 'Vista agregada', color: 'var(--primary)' },
      casaA: { name: 'Casa A', icon: 'ğŸ ', meta: 'Principal Â· Padre', color: 'var(--primary)' },
      casaB: { name: 'Casa B', icon: 'ğŸ¡', meta: 'Madre', color: 'var(--success)' },
      segundaViv: { name: '2Âª Vivienda', icon: 'â›°ï¸', meta: 'MontaÃ±a', color: 'var(--accent)' },
      verano: { name: 'Verano 2024', icon: 'ğŸ–ï¸', meta: 'Alquiler Â· Costa', color: 'var(--warning)' }
    };

    function renderMain() {
      const html = `
        <div class="page-content">
          <div class="page-header">
            <h1 class="page-title"><span>ğŸ“š</span> Cerebro</h1>
            <p class="page-subtitle">Todo lo que la familia sabe, en un sitio</p>
          </div>

          <!-- ÃMBITOS -->
          <div class="ambitos-section">
            <div class="ambitos-scroll">
              ${Object.entries(ambitos).map(([key, amb]) => `
                <div class="ambito-card ${currentAmbito === key ? 'active' : ''}" onclick="selectAmbito('${key}')">
                  <div class="ambito-icon">${amb.icon}</div>
                  <div class="ambito-name">${amb.name}</div>
                  <div class="ambito-meta">${amb.meta}</div>
                </div>
              `).join('')}
            </div>
          </div>

          <!-- SUGERENCIA SUTIL (adaptada por perfil) -->
          <div class="hint-bubble" id="hintBubble">
            <div class="hint-icon">ğŸ’¡</div>
            <div class="hint-text" id="hintText">
              <!-- Se rellena dinÃ¡micamente segÃºn perfil -->
            </div>
            <div class="hint-dismiss" onclick="dismissHint(event)">Ã—</div>
          </div>

          <!-- SELECTOR DE PERFIL (demo) -->
          <div style="display: flex; gap: 8px; margin-bottom: 20px; flex-wrap: wrap;">
            <div style="font-size: 0.75rem; color: var(--text-muted); width: 100%; margin-bottom: 4px;">Ver como:</div>
            <button class="pill active" onclick="changeProfile('padre')" id="profile-padre">ğŸ‘” Padre</button>
            <button class="pill" onclick="changeProfile('madre')" id="profile-madre">ğŸ‘© Madre</button>
            <button class="pill" onclick="changeProfile('hijo22')" id="profile-hijo22">ğŸ“ Marcos (22)</button>
            <button class="pill" onclick="changeProfile('hijo16')" id="profile-hijo16">âš½ Pablo (16)</button>
          </div>

          <!-- CONTENIDO SEGÃšN ÃMBITO -->
          <div id="ambitoContent">
            ${renderAmbitoContent(currentAmbito)}
          </div>
        </div>
      `;
      document.getElementById('mainContent').innerHTML = html;
      setTimeout(updateHint, 50);
    }

    function renderAmbitoContent(ambito) {
      if (ambito === 'general') {
        return renderGeneralView();
      } else {
        return renderSpaceView(ambito);
      }
    }

    function renderGeneralView() {
      return `
        <!-- VISTA GENERAL: AGREGADORA -->

        <!-- PRÃ“XIMAMENTE: CUMPLES E HITOS -->
        <section class="card" style="background: linear-gradient(135deg, #FDF6EE 0%, #FEF9E7 100%); border-left: 4px solid var(--warning);">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ‚</span> PrÃ³ximamente</h2>
            <span class="card-action">Ver calendario</span>
          </div>
          
          <div style="display: flex; flex-direction: column; gap: 10px;">
            <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--white); border-radius: var(--radius-md);">
              <div style="width: 44px; height: 44px; background: linear-gradient(135deg, var(--warning) 0%, #F0D060 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 1.3rem;">ğŸ‚</div>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 0.9rem;">Cumple Abuela Carmen</div>
                <div style="font-size: 0.75rem; color: var(--text-muted);">En 5 dÃ­as Â· 78 aÃ±os</div>
              </div>
              <div style="padding: 4px 10px; background: var(--warning); color: white; font-size: 0.7rem; font-weight: 600; border-radius: var(--radius-lg);">12 dic</div>
            </div>
            
            <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--white); border-radius: var(--radius-md);">
              <div style="width: 44px; height: 44px; background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 1.3rem;">ğŸ“</div>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 0.9rem;">Entrega TFG Marcos</div>
                <div style="font-size: 0.75rem; color: var(--text-muted);">Â¡El gran dÃ­a!</div>
              </div>
              <div style="padding: 4px 10px; background: var(--accent); color: white; font-size: 0.7rem; font-weight: 600; border-radius: var(--radius-lg);">13 dic</div>
            </div>

            <div style="display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--white); border-radius: var(--radius-md);">
              <div style="width: 44px; height: 44px; background: var(--secondary); border-radius: var(--radius-md); display: flex; align-items: center; justify-content: center; font-size: 1.3rem;">ğŸ’‘</div>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 0.9rem;">Aniversario Abuelos</div>
                <div style="font-size: 0.75rem; color: var(--text-muted);">50 aÃ±os casados ğŸ’</div>
              </div>
              <div style="padding: 4px 10px; background: var(--text-muted); color: white; font-size: 0.7rem; font-weight: 600; border-radius: var(--radius-lg);">22 dic</div>
            </div>
          </div>
        </section>

        <!-- HITOS RECIENTES -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ†</span> Hitos familiares</h2>
            <span class="card-action">+ AÃ±adir</span>
          </div>
          
          <div style="display: flex; flex-direction: column; gap: 8px;">
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px 14px; background: linear-gradient(90deg, #E8F5E9 0%, var(--secondary) 100%); border-radius: var(--radius-md); border-left: 3px solid var(--success);">
              <span style="font-size: 1.2rem;">ğŸš—</span>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 0.85rem;">Pablo sacÃ³ el carnet de moto</div>
                <div style="font-size: 0.7rem; color: var(--text-muted);">Noviembre 2024</div>
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px 14px; background: linear-gradient(90deg, #E3F2FD 0%, var(--secondary) 100%); border-radius: var(--radius-md); border-left: 3px solid var(--primary);">
              <span style="font-size: 1.2rem;">ğŸ </span>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 0.85rem;">Reformamos la cocina Casa A</div>
                <div style="font-size: 0.7rem; color: var(--text-muted);">Octubre 2024</div>
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px 14px; background: linear-gradient(90deg, #FFF3E0 0%, var(--secondary) 100%); border-radius: var(--radius-md); border-left: 3px solid var(--accent);">
              <span style="font-size: 1.2rem;">ğŸ•</span>
              <div style="flex: 1;">
                <div style="font-weight: 600; font-size: 0.85rem;">LlegÃ³ Luna a la familia</div>
                <div style="font-size: 0.7rem; color: var(--text-muted);">Septiembre 2024</div>
              </div>
            </div>
          </div>
        </section>
        
        <!-- ESPACIOS -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ“</span> Todos los espacios</h2>
          </div>
          
          <div class="agregado-card">
            <div class="agregado-header">
              <span>ğŸ”§</span>
              <span class="agregado-title">Proveedores (todos)</span>
            </div>
            <div class="agregado-items">
              <div class="agregado-item"><span class="agregado-item-icon">ğŸ </span> 4 en Casa A</div>
              <div class="agregado-item"><span class="agregado-item-icon">ğŸ¡</span> 3 en Casa B</div>
              <div class="agregado-item"><span class="agregado-item-icon">â›°ï¸</span> 2 en 2Âª Viv</div>
            </div>
          </div>

          <div class="agregado-card">
            <div class="agregado-header">
              <span>ğŸ“‹</span>
              <span class="agregado-title">Protocolos</span>
            </div>
            <div class="agregado-items">
              <div class="agregado-item"><span class="agregado-item-icon">ğŸŒ</span> 5 generales</div>
              <div class="agregado-item"><span class="agregado-item-icon">ğŸ </span> 8 Casa A</div>
              <div class="agregado-item"><span class="agregado-item-icon">ğŸ¡</span> 6 Casa B</div>
            </div>
          </div>

          <div class="quick-grid" style="margin-top: 16px;">
            <div class="quick-item" onclick="showView('space', 'casaA')">
              <div class="quick-icon">ğŸ </div>
              <div class="quick-label">Casa A</div>
            </div>
            <div class="quick-item" onclick="showView('space', 'casaB')">
              <div class="quick-icon">ğŸ¡</div>
              <div class="quick-label">Casa B</div>
            </div>
            <div class="quick-item" onclick="showView('space', 'segundaViv')">
              <div class="quick-icon">â›°ï¸</div>
              <div class="quick-label">2Âª Vivienda</div>
            </div>
          </div>
        </section>

        <!-- LA TRIBU -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ‘¥</span> La tribu</h2>
            <span class="card-action">Ver detalles</span>
          </div>
          
          <div class="members-grid">
            <div class="member-card">
              <div class="member-avatar" style="background: var(--primary);">F</div>
              <div class="member-name">Felipe</div>
              <div class="member-role">Padre</div>
              <div class="member-location">ğŸ“ Casa A</div>
            </div>
            <div class="member-card">
              <div class="member-avatar" style="background: var(--success);">E</div>
              <div class="member-name">Elena</div>
              <div class="member-role">Madre</div>
              <div class="member-location">ğŸ“ Casa B</div>
            </div>
            <div class="member-card">
              <div class="member-avatar" style="background: var(--accent);">M</div>
              <div class="member-name">Marcos</div>
              <div class="member-role">22 aÃ±os</div>
              <div class="member-location">ğŸ“ Casa A</div>
            </div>
            <div class="member-card">
              <div class="member-avatar" style="background: var(--warning);">P</div>
              <div class="member-name">Pablo</div>
              <div class="member-role">16 aÃ±os</div>
              <div class="member-location">ğŸ“ Casa A</div>
            </div>
          </div>
        </section>

        <!-- PROTOCOLOS GENERALES -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ“‹</span> Protocolos comunes</h2>
            <span class="card-action">+ AÃ±adir</span>
          </div>
          
          <div class="protocol-card">
            <div class="protocol-icon">ğŸš¨</div>
            <div class="protocol-content">
              <div class="protocol-title">QuÃ© hacer si... (emergencias)</div>
              <div class="protocol-meta">TelÃ©fonos, pasos, contactos</div>
              <div class="protocol-tags">
                <span class="protocol-tag">ğŸŒ General</span>
                <span class="protocol-tag">Importante</span>
              </div>
            </div>
          </div>

          <div class="protocol-card">
            <div class="protocol-icon">ğŸ”„</div>
            <div class="protocol-content">
              <div class="protocol-title">Paso de testigo</div>
              <div class="protocol-meta">QuÃ© revisar al cambiar de casa</div>
              <div class="protocol-tags">
                <span class="protocol-tag">ğŸŒ General</span>
              </div>
            </div>
          </div>

          <div class="protocol-card">
            <div class="protocol-icon">ğŸ’Š</div>
            <div class="protocol-content">
              <div class="protocol-title">MedicaciÃ³n Pablo</div>
              <div class="protocol-meta">Horarios y dosis</div>
              <div class="protocol-tags">
                <span class="protocol-tag">ğŸŒ General</span>
                <span class="protocol-tag">Salud</span>
              </div>
            </div>
          </div>
        </section>

        <!-- CONTACTOS COMUNES -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ“</span> Contactos clave</h2>
            <span class="card-action">Ver todos</span>
          </div>
          
          <div class="info-list">
            <div class="info-item">
              <div class="info-icon">ğŸ‘¨â€âš•ï¸</div>
              <div class="info-content">
                <div class="info-title">Dr. MartÃ­nez</div>
                <div class="info-subtitle">Pediatra Pablo Â· 91 234 56 78</div>
              </div>
              <span class="info-arrow">â€º</span>
            </div>
            <div class="info-item">
              <div class="info-icon">ğŸ«</div>
              <div class="info-content">
                <div class="info-title">IES Cervantes</div>
                <div class="info-subtitle">Instituto Pablo Â· SecretarÃ­a</div>
              </div>
              <span class="info-arrow">â€º</span>
            </div>
            <div class="info-item">
              <div class="info-icon">ğŸ“</div>
              <div class="info-content">
                <div class="info-title">Facultad EconÃ³micas</div>
                <div class="info-subtitle">Universidad Marcos</div>
              </div>
              <span class="info-arrow">â€º</span>
            </div>
          </div>
        </section>

        <!-- ALQUILER TEMPORAL -->
        <section class="card" style="background: linear-gradient(135deg, #FEF9E7 0%, var(--secondary) 100%); border: 1px dashed var(--warning);">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ–ï¸</span> Verano 2024</h2>
            <span class="info-badge" style="background: var(--warning);">Temporal</span>
          </div>
          <p style="font-size: 0.85rem; color: var(--text-light); margin-bottom: 12px;">
            Alquiler en Costa Brava Â· 15-30 agosto
          </p>
          <div class="info-list">
            <div class="info-item" style="background: var(--white);">
              <div class="info-icon">ğŸ”‘</div>
              <div class="info-content">
                <div class="info-title">Datos del alquiler</div>
                <div class="info-subtitle">DirecciÃ³n, contacto, normas</div>
              </div>
              <span class="info-arrow">â€º</span>
            </div>
          </div>
        </section>
      `;
    }

    function renderSpaceView(spaceKey) {
      const space = ambitos[spaceKey];
      
      const spaceData = {
        casaA: {
          address: 'C/ Principal 123, Madrid',
          providers: [
            { icon: 'ğŸ”§', name: 'Fontanero Pepe', phone: '600 123 456', rating: 'â­â­â­â­â­' },
            { icon: 'âš¡', name: 'Electricista Juan', phone: '600 789 012', rating: 'â­â­â­â­' },
            { icon: 'ğŸ§¹', name: 'Limpieza MarÃ­a', phone: '600 345 678', rating: 'â­â­â­â­â­' },
            { icon: 'ğŸ”’', name: 'Cerrajero 24h', phone: '900 111 222', rating: 'â­â­â­' }
          ],
          protocols: [
            { icon: 'ğŸ§º', title: 'Lavadora', meta: 'Programas y carga mÃ¡xima' },
            { icon: 'ğŸŒ¡ï¸', title: 'CalefacciÃ³n', meta: 'Termostato y programaciÃ³n' },
            { icon: 'ğŸš—', title: 'Garaje', meta: 'Mando y normas comunidad' }
          ],
          inventory: ['Despensa', 'BotiquÃ­n', 'Limpieza']
        },
        casaB: {
          address: 'Av. Secundaria 45, Madrid',
          providers: [
            { icon: 'ğŸ”§', name: 'FontanerÃ­a RÃ¡pida', phone: '600 222 333', rating: 'â­â­â­â­' },
            { icon: 'âš¡', name: 'ElectroServ', phone: '600 444 555', rating: 'â­â­â­â­â­' },
            { icon: 'ğŸ ', name: 'Administrador finca', phone: '91 000 11 22', rating: '' }
          ],
          protocols: [
            { icon: 'ğŸ§º', title: 'Lavadora', meta: 'Diferente modelo' },
            { icon: 'â„ï¸', title: 'Aire acondicionado', meta: 'Mandos y filtros' }
          ],
          inventory: ['Despensa', 'BotiquÃ­n']
        },
        segundaViv: {
          address: 'UrbanizaciÃ³n Sierra, Navacerrada',
          providers: [
            { icon: 'ğŸ”‘', name: 'GuardÃ©s Antonio', phone: '600 666 777', rating: 'â­â­â­â­â­' },
            { icon: 'ğŸ”§', name: 'Mantenimiento local', phone: '600 888 999', rating: 'â­â­â­â­' }
          ],
          protocols: [
            { icon: 'ğŸ”¥', title: 'Chimenea', meta: 'Encendido y limpieza' },
            { icon: 'ğŸ’§', title: 'Agua', meta: 'Llaves de paso invierno' },
            { icon: 'ğŸš—', title: 'Acceso', meta: 'Cadenas nieve, parking' }
          ],
          inventory: ['BÃ¡sicos', 'LeÃ±a']
        }
      };

      const data = spaceData[spaceKey] || spaceData.casaA;

      return `
        <div class="space-header">
          <div class="space-header-top">
            <div class="space-header-icon">${space.icon}</div>
            <div class="space-header-info">
              <div class="space-header-title">${space.name}</div>
              <div class="space-header-subtitle">${data.address}</div>
            </div>
          </div>
          <div class="space-stats">
            <div class="space-stat">
              <div class="space-stat-value">${data.providers.length}</div>
              <div class="space-stat-label">Proveedores</div>
            </div>
            <div class="space-stat">
              <div class="space-stat-value">${data.protocols.length}</div>
              <div class="space-stat-label">Protocolos</div>
            </div>
            <div class="space-stat">
              <div class="space-stat-value">${data.inventory.length}</div>
              <div class="space-stat-label">Inventarios</div>
            </div>
          </div>
        </div>

        <!-- CATEGORÃAS -->
        <div class="category-pills">
          <button class="pill active">Todo</button>
          <button class="pill">Proveedores</button>
          <button class="pill">Protocolos</button>
          <button class="pill">Inventario</button>
          <button class="pill">Docs</button>
        </div>

        <!-- PROVEEDORES -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ”§</span> Proveedores</h2>
            <span class="card-action">+ AÃ±adir</span>
          </div>
          <div class="info-list">
            ${data.providers.map(p => `
              <div class="info-item">
                <div class="info-icon">${p.icon}</div>
                <div class="info-content">
                  <div class="info-title">${p.name}</div>
                  <div class="info-subtitle">${p.phone} ${p.rating}</div>
                </div>
                <span class="info-arrow">â€º</span>
              </div>
            `).join('')}
          </div>
        </section>

        <!-- PROTOCOLOS DEL ESPACIO -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ“‹</span> CÃ³mo funciona aquÃ­</h2>
            <span class="card-action">+ AÃ±adir</span>
          </div>
          ${data.protocols.map(p => `
            <div class="protocol-card">
              <div class="protocol-icon">${p.icon}</div>
              <div class="protocol-content">
                <div class="protocol-title">${p.title}</div>
                <div class="protocol-meta">${p.meta}</div>
              </div>
            </div>
          `).join('')}
        </section>

        <!-- INVENTARIOS -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ“¦</span> Inventarios</h2>
          </div>
          <div class="quick-grid">
            ${data.inventory.map(inv => `
              <div class="quick-item">
                <div class="quick-icon">${inv === 'Despensa' ? 'ğŸ¥«' : inv === 'BotiquÃ­n' ? 'ğŸ’Š' : inv === 'Limpieza' ? 'ğŸ§¹' : inv === 'BÃ¡sicos' ? 'ğŸ§´' : 'ğŸªµ'}</div>
                <div class="quick-label">${inv}</div>
              </div>
            `).join('')}
          </div>
        </section>

        <!-- DOCUMENTOS -->
        <section class="card">
          <div class="card-header">
            <h2 class="card-title"><span class="card-title-icon">ğŸ“„</span> Documentos</h2>
          </div>
          <div class="info-list">
            <div class="info-item">
              <div class="info-icon">ğŸ“œ</div>
              <div class="info-content">
                <div class="info-title">Contrato alquiler / Escrituras</div>
                <div class="info-subtitle">PDF Â· Actualizado</div>
              </div>
              <span class="info-arrow">â€º</span>
            </div>
            <div class="info-item">
              <div class="info-icon">ğŸ›¡ï¸</div>
              <div class="info-content">
                <div class="info-title">Seguro hogar</div>
                <div class="info-subtitle">PÃ³liza Â· Vence 03/2025</div>
              </div>
              <span class="info-arrow">â€º</span>
            </div>
          </div>
        </section>
      `;
    }

    function selectAmbito(ambito) {
      currentAmbito = ambito;
      renderMain();
    }

    function showView(view, param) {
      if (view === 'space') {
        currentAmbito = param;
        renderMain();
      }
    }

    function dismissHint(e) {
      e.stopPropagation();
      document.getElementById('hintBubble').style.display = 'none';
    }

    // Initialize
    renderMain();
    setTimeout(updateHint, 100);
  </script>

</body>
</html>
