<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FAMILYNK â€” Empezar</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Quicksand:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --sage: #7A9E7E;
      --sage-light: #9BB89E;
      --sage-dark: #5C7D5F;
      --cream: #FDF8F3;
      --cream-dark: #F5EDE4;
      --terracotta: #C17757;
      --mayordomo: #8B7355;
      --mayordomo-light: #A69076;
      --gerente: #4A5568;
      --gerente-light: #718096;
      --capataz: #6B8E23;
      --capataz-light: #8FBC3B;
      --crear-rama: #7A9E7E;
      --crear-rama-light: #9BB89E;
      --text: #3D3D3D;
      --text-light: #6B6B6B;
      --text-muted: #9A9A9A;
      --white: #FFFFFF;
      --shadow-soft: 0 2px 8px rgba(0,0,0,0.06);
      --shadow-medium: 0 4px 16px rgba(0,0,0,0.08);
      --shadow-float: 0 8px 30px rgba(0,0,0,0.12);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Nunito', sans-serif;
      background: var(--cream);
      color: var(--text);
      min-height: 100vh;
    }

    .header {
      background: var(--white);
      padding: 16px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-soft);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--cream);
      border: none;
      border-radius: var(--radius-md);
      font-family: 'Nunito', sans-serif;
      font-size: 0.85rem;
      color: var(--text-light);
      cursor: pointer;
      text-decoration: none;
      transition: all 0.2s;
    }

    .back-btn:hover { background: var(--cream-dark); }

    .header-title {
      font-family: 'Quicksand', sans-serif;
      font-weight: 700;
      font-size: 1.2rem;
    }

    .main {
      max-width: 900px;
      margin: 0 auto;
      padding: 32px 24px;
    }

    .intro {
      text-align: center;
      margin-bottom: 40px;
    }

    .intro-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 12px;
    }

    .intro-text {
      font-size: 1rem;
      color: var(--text-light);
      max-width: 600px;
      margin: 0 auto;
    }

    /* Addon Cards */
    .addons-grid {
      display: grid;
      gap: 24px;
    }

    .addon-card {
      background: var(--white);
      border-radius: var(--radius-xl);
      overflow: hidden;
      box-shadow: var(--shadow-medium);
      transition: all 0.3s;
      cursor: pointer;
    }

    .addon-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-float);
    }

    .addon-header {
      padding: 24px;
      color: white;
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .addon-header.mayordomo { background: linear-gradient(135deg, var(--mayordomo) 0%, var(--mayordomo-light) 100%); }
    .addon-header.gerente { background: linear-gradient(135deg, var(--gerente) 0%, var(--gerente-light) 100%); }
    .addon-header.capataz { background: linear-gradient(135deg, var(--capataz) 0%, var(--capataz-light) 100%); }
    .addon-header.crear-rama { background: linear-gradient(135deg, var(--crear-rama) 0%, var(--crear-rama-light) 100%); }

    .addon-icon {
      width: 56px;
      height: 56px;
      background: rgba(255,255,255,0.2);
      border-radius: var(--radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
    }

    .addon-title-area { flex: 1; }

    .addon-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      font-weight: 700;
    }

    .addon-subtitle {
      font-size: 0.85rem;
      opacity: 0.9;
    }

    .addon-badge {
      background: rgba(255,255,255,0.25);
      padding: 6px 12px;
      border-radius: var(--radius-sm);
      font-size: 0.75rem;
      font-weight: 600;
    }

    .addon-body {
      padding: 24px;
    }

    .addon-desc {
      font-size: 0.95rem;
      color: var(--text-light);
      line-height: 1.6;
      margin-bottom: 20px;
    }

    .addon-features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }

    .addon-feature {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.85rem;
      color: var(--text);
    }

    .addon-feature-icon {
      width: 28px;
      height: 28px;
      background: var(--cream);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
    }

    .addon-cta {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding-top: 16px;
      border-top: 1px solid var(--cream-dark);
    }

    .addon-status {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .addon-status.active {
      color: var(--sage-dark);
      font-weight: 600;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 12px 20px;
      border-radius: var(--radius-md);
      font-family: 'Nunito', sans-serif;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.2s;
      text-decoration: none;
    }

    .btn-mayordomo { background: var(--mayordomo); color: white; }
    .btn-mayordomo:hover { background: #7a6448; }
    .btn-gerente { background: var(--gerente); color: white; }
    .btn-gerente:hover { background: #3d4654; }
    .btn-capataz { background: var(--capataz); color: white; }
    .btn-capataz:hover { background: #5a7a1e; }
    .btn-crear-rama { background: var(--crear-rama); color: white; }
    .btn-crear-rama:hover { background: #5C7D5F; }

    .btn-outline {
      background: transparent;
      border: 2px solid var(--cream-dark);
      color: var(--text-light);
    }

    .btn-outline:hover {
      background: var(--cream);
    }

    /* Expanded state */
    .addon-expanded {
      display: none;
      padding: 0 24px 24px;
    }

    .addon-card.expanded .addon-expanded {
      display: block;
    }

    .addon-modules {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
    }

    .addon-module {
      background: var(--cream);
      padding: 14px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .addon-module-icon {
      font-size: 1.2rem;
    }

    .addon-module-info { flex: 1; }

    .addon-module-name {
      font-weight: 600;
      font-size: 0.85rem;
    }

    .addon-module-desc {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .section-title {
      font-family: 'Quicksand', sans-serif;
      font-weight: 700;
      font-size: 0.9rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 12px;
    }

    /* Modal detalle */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s;
      padding: 20px;
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background: var(--white);
      border-radius: var(--radius-xl);
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      transform: translateY(20px) scale(0.95);
      transition: transform 0.3s;
    }

    .modal-overlay.active .modal {
      transform: translateY(0) scale(1);
    }

    .modal-header {
      padding: 24px;
      color: white;
      position: relative;
    }

    .modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 36px;
      height: 36px;
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 50%;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-close:hover {
      background: rgba(255,255,255,0.3);
    }

    .modal-icon {
      font-size: 3rem;
      margin-bottom: 16px;
    }

    .modal-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
      margin-bottom: 8px;
    }

    .modal-subtitle {
      opacity: 0.9;
      font-size: 0.95rem;
    }

    .modal-body {
      padding: 24px;
    }

    .modal-section {
      margin-bottom: 24px;
    }

    .modal-section:last-child {
      margin-bottom: 0;
    }

    .modal-section-title {
      font-family: 'Quicksand', sans-serif;
      font-weight: 700;
      font-size: 1rem;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .modal-text {
      font-size: 0.9rem;
      color: var(--text-light);
      line-height: 1.6;
    }

    .modal-list {
      list-style: none;
    }

    .modal-list li {
      padding: 10px 0;
      border-bottom: 1px solid var(--cream-dark);
      display: flex;
      align-items: flex-start;
      gap: 12px;
      font-size: 0.9rem;
    }

    .modal-list li:last-child {
      border-bottom: none;
    }

    .modal-list-icon {
      width: 32px;
      height: 32px;
      background: var(--cream);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1rem;
      flex-shrink: 0;
    }

    .modal-list-content { flex: 1; }

    .modal-list-title {
      font-weight: 600;
      margin-bottom: 2px;
    }

    .modal-list-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .modal-footer {
      padding: 20px 24px;
      border-top: 1px solid var(--cream-dark);
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    @media (max-width: 600px) {
      .addon-features {
        grid-template-columns: 1fr 1fr;
      }
      
      .addon-modules {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-left">
      <a href="cgi.html" class="back-btn">â† Volver</a>
      <div class="header-title">Empezar con FAMILYNK</div>
    </div>
  </header>

  <main class="main">
    <div class="intro">
      <h1 class="intro-title">Bienvenido a FAMILYNK</h1>
      <p class="intro-text">Elige cÃ³mo quieres empezar. Activa los mÃ³dulos segÃºn el tipo de bienes que gestionas o crea una nueva rama familiar.</p>
    </div>

    <div class="addons-grid">
      <!-- MAYORDOMO -->
      <div class="addon-card" onclick="abrirDetalle('mayordomo')">
        <div class="addon-header mayordomo">
          <div class="addon-icon">ğŸ©</div>
          <div class="addon-title-area">
            <div class="addon-title">Mayordomo</div>
            <div class="addon-subtitle">GestiÃ³n residencial</div>
          </div>
          <div class="addon-badge">Viviendas</div>
        </div>
        <div class="addon-body">
          <p class="addon-desc">
            Coordina el uso de viviendas familiares: casas de pueblo, apartamentos de playa, chalets... 
            Gestiona turnos, inventarios y mantenimiento de forma colaborativa.
          </p>
          <div class="addon-features">
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ“…</span> Estancias</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ“¦</span> Inventario</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ”§</span> Mantenimiento</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ§¹</span> Limpieza</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ’°</span> Gastos</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ—ï¸</span> Instalaciones</div>
          </div>
          <div class="addon-cta">
            <span class="addon-status" id="status-mayordomo">Sin activar</span>
            <button class="btn btn-mayordomo">Ver detalles â†’</button>
          </div>
        </div>
      </div>

      <!-- GERENTE -->
      <div class="addon-card" onclick="abrirDetalle('gerente')">
        <div class="addon-header gerente">
          <div class="addon-icon">ğŸ¨</div>
          <div class="addon-title-area">
            <div class="addon-title">Gerente</div>
            <div class="addon-subtitle">GestiÃ³n comercial</div>
          </div>
          <div class="addon-badge">Alquiler</div>
        </div>
        <div class="addon-body">
          <p class="addon-desc">
            Profesionaliza el alquiler de tus propiedades. Control de reservas, huÃ©spedes, tarifas y facturaciÃ³n.
            Ideal para casas rurales, apartamentos turÃ­sticos o habitaciones.
          </p>
          <div class="addon-features">
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ“…</span> Reservas</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ›ï¸</span> Habitaciones</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ‘¥</span> HuÃ©spedes</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ’¶</span> Tarifas</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ§¾</span> FacturaciÃ³n</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ—ï¸</span> Instalaciones</div>
          </div>
          <div class="addon-cta">
            <span class="addon-status" id="status-gerente">Sin activar</span>
            <button class="btn btn-gerente">Ver detalles â†’</button>
          </div>
        </div>
      </div>

      <!-- CAPATAZ -->
      <div class="addon-card" onclick="abrirDetalle('capataz')">
        <div class="addon-header capataz">
          <div class="addon-icon">ğŸŒ¾</div>
          <div class="addon-title-area">
            <div class="addon-title">Capataz</div>
            <div class="addon-subtitle">GestiÃ³n rural</div>
          </div>
          <div class="addon-badge">Fincas</div>
        </div>
        <div class="addon-body">
          <p class="addon-desc">
            Administra fincas rÃºsticas, explotaciones agrÃ­colas o terrenos. Control de parcelas, 
            maquinaria, personal y labores del campo.
          </p>
          <div class="addon-features">
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ“…</span> Actividad</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ—ºï¸</span> Parcelas</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸšœ</span> Maquinaria</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ“‹</span> Labores</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸŒ»</span> Cosechas</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ—ï¸</span> Instalaciones</div>
          </div>
          <div class="addon-cta">
            <span class="addon-status" id="status-capataz">Sin activar</span>
            <button class="btn btn-capataz">Ver detalles â†’</button>
          </div>
        </div>
      </div>

      <!-- CREAR RAMA -->
      <div class="addon-card" onclick="abrirDetalle('crear-rama')">
        <div class="addon-header crear-rama">
          <div class="addon-icon">ğŸŒ³</div>
          <div class="addon-title-area">
            <div class="addon-title">Crear Rama</div>
            <div class="addon-subtitle">Nueva familia</div>
          </div>
          <div class="addon-badge">DinastÃ­a</div>
        </div>
        <div class="addon-body">
          <p class="addon-desc">
            Inicia una nueva rama familiar en FAMILYNK. Configura tu dinastÃ­a, 
            invita a los miembros y empieza a coordinar tu familia.
          </p>
          <div class="addon-features">
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span> Tu nido</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸŒ³</span> Ãrbol familiar</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ“§</span> Invitaciones</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ </span> Bienes comunes</div>
            <div class="addon-feature"><span class="addon-feature-icon">ğŸ‘¥</span> Roles</div>
            <div class="addon-feature"><span class="addon-feature-icon">âš™ï¸</span> ConfiguraciÃ³n</div>
          </div>
          <div class="addon-cta">
            <span class="addon-status">Proceso guiado</span>
            <button class="btn btn-crear-rama">Empezar â†’</button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Modal Mayordomo -->
  <div class="modal-overlay" id="modal-mayordomo">
    <div class="modal">
      <div class="modal-header mayordomo" style="background: linear-gradient(135deg, var(--mayordomo) 0%, var(--mayordomo-light) 100%);">
        <button class="modal-close" onclick="cerrarModal('mayordomo')">Ã—</button>
        <div class="modal-icon">ğŸ©</div>
        <div class="modal-title">Mayordomo</div>
        <div class="modal-subtitle">GestiÃ³n integral de viviendas familiares</div>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <div class="modal-section-title">ğŸ¯ Â¿Para quiÃ©n es?</div>
          <p class="modal-text">
            Para familias que comparten una o varias viviendas: la casa del pueblo, el apartamento de la playa, 
            el chalet de la sierra... Mayordomo ayuda a coordinar quiÃ©n la usa, quÃ© hay dentro y quÃ© necesita mantenimiento.
          </p>
        </div>

        <div class="modal-section">
          <div class="modal-section-title">ğŸ“¦ MÃ³dulos incluidos</div>
          <ul class="modal-list">
            <li>
              <span class="modal-list-icon">ğŸ“…</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Estancias</div>
                <div class="modal-list-desc">Calendario compartido de uso. Reserva turnos y evita conflictos.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ“¦</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Inventario</div>
                <div class="modal-list-desc">Control de productos consumibles con alertas de stock bajo.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸª‘</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Ajuar</div>
                <div class="modal-list-desc">CatÃ¡logo de muebles y enseres con fotos y ubicaciÃ³n.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ”§</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Mantenimiento</div>
                <div class="modal-list-desc">Tareas programadas, averÃ­as e historial de reparaciones.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ§¹</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Limpieza</div>
                <div class="modal-list-desc">Checklists de entrada/salida y turnos de limpieza.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ’°</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Gastos</div>
                <div class="modal-list-desc">Registro y reparto de gastos entre los nidos.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ—ï¸</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Instalaciones</div>
                <div class="modal-list-desc">Control de electricidad, fontanerÃ­a, climatizaciÃ³n y seguridad.</div>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('mayordomo')">Cerrar</button>
        <button class="btn btn-mayordomo" onclick="activarAddon('mayordomo')">Activar Mayordomo</button>
      </div>
    </div>
  </div>

  <!-- Modal Gerente -->
  <div class="modal-overlay" id="modal-gerente">
    <div class="modal">
      <div class="modal-header gerente" style="background: linear-gradient(135deg, var(--gerente) 0%, var(--gerente-light) 100%);">
        <button class="modal-close" onclick="cerrarModal('gerente')">Ã—</button>
        <div class="modal-icon">ğŸ¨</div>
        <div class="modal-title">Gerente</div>
        <div class="modal-subtitle">GestiÃ³n profesional de alquiler</div>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <div class="modal-section-title">ğŸ¯ Â¿Para quiÃ©n es?</div>
          <p class="modal-text">
            Para familias que alquilan propiedades a terceros: casas rurales, apartamentos turÃ­sticos, 
            habitaciones... Gerente profesionaliza la gestiÃ³n con herramientas de reservas, tarifas y facturaciÃ³n.
          </p>
        </div>

        <div class="modal-section">
          <div class="modal-section-title">ğŸ“¦ MÃ³dulos incluidos</div>
          <ul class="modal-list">
            <li>
              <span class="modal-list-icon">ğŸ“…</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Reservas</div>
                <div class="modal-list-desc">GestiÃ³n profesional con check-in/check-out y confirmaciones.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ›ï¸</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Habitaciones</div>
                <div class="modal-list-desc">Define espacios, capacidad y servicios de cada habitaciÃ³n.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ‘¥</span>
              <div class="modal-list-content">
                <div class="modal-list-title">HuÃ©spedes</div>
                <div class="modal-list-desc">Registro de huÃ©spedes con historial y preferencias.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ’¶</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Tarifas</div>
                <div class="modal-list-desc">Precios por temporada, descuentos y ofertas especiales.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ§¾</span>
              <div class="modal-list-content">
                <div class="modal-list-title">FacturaciÃ³n</div>
                <div class="modal-list-desc">Control de ingresos, pagos y generaciÃ³n de facturas.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ—ï¸</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Instalaciones</div>
                <div class="modal-list-desc">Control de electricidad, fontanerÃ­a, climatizaciÃ³n y seguridad.</div>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('gerente')">Cerrar</button>
        <button class="btn btn-gerente" onclick="activarAddon('gerente')">Activar Gerente</button>
      </div>
    </div>
  </div>

  <!-- Modal Capataz -->
  <div class="modal-overlay" id="modal-capataz">
    <div class="modal">
      <div class="modal-header capataz" style="background: linear-gradient(135deg, var(--capataz) 0%, var(--capataz-light) 100%);">
        <button class="modal-close" onclick="cerrarModal('capataz')">Ã—</button>
        <div class="modal-icon">ğŸŒ¾</div>
        <div class="modal-title">Capataz</div>
        <div class="modal-subtitle">GestiÃ³n de fincas y terrenos</div>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <div class="modal-section-title">ğŸ¯ Â¿Para quiÃ©n es?</div>
          <p class="modal-text">
            Para familias con fincas rÃºsticas, explotaciones agrÃ­colas, olivares, viÃ±edos o cualquier terreno 
            que requiera gestiÃ³n de parcelas, maquinaria y labores del campo.
          </p>
        </div>

        <div class="modal-section">
          <div class="modal-section-title">ğŸ“¦ MÃ³dulos incluidos</div>
          <ul class="modal-list">
            <li>
              <span class="modal-list-icon">ğŸ“…</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Actividad</div>
                <div class="modal-list-desc">Calendario de actividades, visitas y eventos en la finca.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ—ºï¸</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Parcelas</div>
                <div class="modal-list-desc">DivisiÃ³n de terrenos, superficies, cultivos y linderos.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸšœ</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Maquinaria</div>
                <div class="modal-list-desc">Inventario de tractores, aperos y equipamiento agrÃ­cola.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ“‹</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Labores</div>
                <div class="modal-list-desc">PlanificaciÃ³n de siembra, tratamientos, riegos y recogida.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸŒ»</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Cosechas</div>
                <div class="modal-list-desc">Registro de producciones, kilos, calidades y destino.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">ğŸ—ï¸</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Instalaciones</div>
                <div class="modal-list-desc">Naves, almacenes, pozos, riego y otras infraestructuras.</div>
              </div>
            </li>
          </ul>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('capataz')">Cerrar</button>
        <button class="btn btn-capataz" onclick="activarAddon('capataz')">Activar Capataz</button>
      </div>
    </div>
  </div>

  <!-- Modal Crear Rama -->
  <div class="modal-overlay" id="modal-crear-rama">
    <div class="modal">
      <div class="modal-header crear-rama" style="background: linear-gradient(135deg, var(--crear-rama) 0%, var(--crear-rama-light) 100%);">
        <button class="modal-close" onclick="cerrarModal('crear-rama')">Ã—</button>
        <div class="modal-icon">ğŸŒ³</div>
        <div class="modal-title">Crear Rama</div>
        <div class="modal-subtitle">Inicia tu Ã¡rbol familiar en FAMILYNK</div>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <div class="modal-section-title">ğŸ¯ Â¿QuÃ© es una Rama?</div>
          <p class="modal-text">
            Una Rama es tu familia en FAMILYNK. Al crearla, te conviertes en el administrador 
            y puedes invitar a todos los miembros: padres, hijos, abuelos, tÃ­os...
            Cada familia tiene su propio espacio privado.
          </p>
        </div>

        <div class="modal-section">
          <div class="modal-section-title">ğŸ“‹ Pasos del proceso</div>
          <ul class="modal-list">
            <li>
              <span class="modal-list-icon">1ï¸âƒ£</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Nombre de tu dinastÃ­a</div>
                <div class="modal-list-desc">El apellido o nombre que identifica a tu familia.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">2ï¸âƒ£</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Tu nido</div>
                <div class="modal-list-desc">Configura tu nÃºcleo familiar: pareja e hijos.</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">3ï¸âƒ£</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Ãrbol genealÃ³gico</div>
                <div class="modal-list-desc">AÃ±ade generaciones: padres, abuelos, hermanos...</div>
              </div>
            </li>
            <li>
              <span class="modal-list-icon">4ï¸âƒ£</span>
              <div class="modal-list-content">
                <div class="modal-list-title">Invitar miembros</div>
                <div class="modal-list-desc">EnvÃ­a invitaciones por email a cada miembro.</div>
              </div>
            </li>
          </ul>
        </div>

        <div class="modal-section">
          <div class="modal-section-title">âœ¨ DespuÃ©s podrÃ¡s...</div>
          <p class="modal-text">
            AÃ±adir bienes comunes (casas, vehÃ­culos), activar mÃ³dulos de gestiÃ³n 
            (Mayordomo, Gerente, Capataz), configurar permisos y empezar a coordinar tu familia.
          </p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="cerrarModal('crear-rama')">Cancelar</button>
        <a href="crear-rama.html" class="btn btn-crear-rama">ğŸŒ³ Empezar ahora</a>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="firebase-config.js"></script>

  <script>
    const db = firebase.firestore();
    const auth = firebase.auth();

    let familiaId = null;
    let familiaData = null;

    auth.onAuthStateChanged(async (user) => {
      if (!user) {
        window.location.href = 'login.html';
        return;
      }

      // Obtener familia del usuario
      try {
        const userDoc = await db.collection('usuarios').doc(user.uid).get();
        if (userDoc.exists) {
          familiaId = userDoc.data().familiaId;
          if (familiaId) {
            const famDoc = await db.collection('familias').doc(familiaId).get();
            if (famDoc.exists) {
              familiaData = { id: famDoc.id, ...famDoc.data() };
              actualizarEstados();
            }
          }
        }
      } catch (error) {
        console.error('Error cargando datos:', error);
      }
    });

    function actualizarEstados() {
      if (!familiaData) return;

      const addons = familiaData.addons || {};

      ['mayordomo', 'gerente', 'capataz'].forEach(addon => {
        const statusEl = document.getElementById(`status-${addon}`);
        if (statusEl) {
          if (addons[addon]) {
            statusEl.textContent = 'âœ“ Activo';
            statusEl.classList.add('active');
          } else {
            statusEl.textContent = 'Sin activar';
            statusEl.classList.remove('active');
          }
        }
      });
    }

    function abrirDetalle(addon) {
      document.getElementById(`modal-${addon}`).classList.add('active');
    }

    function cerrarModal(addon) {
      document.getElementById(`modal-${addon}`).classList.remove('active');
    }

    async function activarAddon(addon) {
      if (!familiaId) {
        alert('No se encontrÃ³ la familia');
        return;
      }

      try {
        await db.collection('familias').doc(familiaId).update({
          [`addons.${addon}`]: true,
          [`addons.${addon}FechaActivacion`]: firebase.firestore.FieldValue.serverTimestamp()
        });

        // Actualizar estado local
        if (!familiaData.addons) familiaData.addons = {};
        familiaData.addons[addon] = true;

        actualizarEstados();
        cerrarModal(addon);

        alert(`Â¡${addon.charAt(0).toUpperCase() + addon.slice(1)} activado! Ya puedes usarlo en tus bienes.`);
      } catch (error) {
        console.error('Error activando addon:', error);
        alert('Error al activar: ' + error.message);
      }
    }

    // Cerrar modal al hacer clic fuera
    document.querySelectorAll('.modal-overlay').forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target.classList.contains('modal-overlay')) {
          e.target.classList.remove('active');
        }
      });
    });
  </script>
</body>
</html>
