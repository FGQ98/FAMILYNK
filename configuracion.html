<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FAMILYNK â€” ConfiguraciÃ³n</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&family=Quicksand:wght@500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --sage: #7A9E7E;
      --sage-light: #9BB89E;
      --sage-dark: #5C7D5F;
      --cream: #FDF8F3;
      --cream-dark: #F0EBE3;
      --terracotta: #C17757;
      --terracotta-light: #D4927A;
      --text: #3D3D3D;
      --text-light: #6B6B6B;
      --text-muted: #9A9A9A;
      --white: #FFFFFF;
      --shadow-soft: 0 2px 8px rgba(0,0,0,0.06);
      --shadow-medium: 0 4px 16px rgba(0,0,0,0.1);
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Nunito', sans-serif;
      background: var(--cream);
      color: var(--text);
      min-height: 100vh;
    }

    /* Header */
    .header {
      background: var(--white);
      padding: 16px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-soft);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .back-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 16px;
      background: var(--cream);
      border: none;
      border-radius: var(--radius-md);
      color: var(--text);
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
      font-size: 0.9rem;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
    }

    .back-btn:hover {
      background: var(--sage-light);
      color: var(--white);
    }

    .page-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--sage-dark);
    }

    /* Container */
    .container {
      max-width: 700px;
      margin: 0 auto;
      padding: 24px;
    }

    /* Secciones */
    .section {
      background: var(--white);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      margin-bottom: 20px;
      overflow: hidden;
    }

    .section-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--cream-dark);
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .section-icon {
      width: 40px;
      height: 40px;
      background: var(--cream);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
    }

    .section-title {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text);
    }

    .section-subtitle {
      font-size: 0.85rem;
      color: var(--text-light);
      margin-top: 2px;
    }

    .section-body {
      padding: 24px;
    }

    /* Avatar */
    .avatar-options {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .avatar-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      padding: 16px;
      background: var(--cream);
      border: 2px solid transparent;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s;
      min-width: 100px;
    }

    .avatar-option:hover {
      border-color: var(--sage-light);
    }

    .avatar-option.active {
      border-color: var(--sage);
      background: rgba(122, 158, 126, 0.1);
    }

    .avatar-preview {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--white);
    }

    .avatar-preview.inicial { background: var(--sage); }
    .avatar-preview.emoji { background: var(--terracotta); font-size: 2rem; }
    .avatar-preview.foto { background: var(--cream-dark); overflow: hidden; }
    .avatar-preview.foto img { width: 100%; height: 100%; object-fit: cover; }

    .avatar-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text);
    }

    /* Selector de emoji para avatar */
    .emoji-avatar-selector {
      display: none;
      margin-top: 16px;
      padding: 16px;
      background: var(--cream);
      border-radius: var(--radius-md);
    }

    .emoji-avatar-selector.visible {
      display: block;
    }

    .emoji-avatar-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .emoji-avatar-btn {
      width: 44px;
      height: 44px;
      border: none;
      background: var(--white);
      border-radius: var(--radius-sm);
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.2s;
    }

    .emoji-avatar-btn:hover {
      background: var(--sage-light);
      transform: scale(1.1);
    }

    .emoji-avatar-btn.selected {
      background: var(--sage);
      box-shadow: 0 0 0 2px var(--sage-dark);
    }

    /* Foto upload */
    .foto-upload {
      display: none;
      margin-top: 16px;
    }

    .foto-upload.visible {
      display: block;
    }

    .foto-upload-area {
      padding: 24px;
      border: 2px dashed var(--sage-light);
      border-radius: var(--radius-md);
      text-align: center;
      cursor: pointer;
      transition: all 0.2s;
    }

    .foto-upload-area:hover {
      border-color: var(--sage);
      background: rgba(122, 158, 126, 0.05);
    }

    .foto-upload-icon {
      font-size: 2rem;
      margin-bottom: 8px;
    }

    .foto-upload-text {
      font-size: 0.9rem;
      color: var(--text-light);
    }

    /* Paleta de colores */
    .color-themes {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    @media (max-width: 500px) {
      .color-themes {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .color-theme {
      padding: 16px;
      border: 2px solid transparent;
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s;
      text-align: center;
    }

    .color-theme:hover {
      border-color: var(--text-muted);
    }

    .color-theme.active {
      border-color: var(--sage);
      box-shadow: 0 0 0 3px rgba(122, 158, 126, 0.2);
    }

    .color-preview {
      display: flex;
      gap: 4px;
      justify-content: center;
      margin-bottom: 10px;
    }

    .color-dot {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      border: 2px solid var(--white);
      box-shadow: 0 1px 3px rgba(0,0,0,0.15);
    }

    .color-theme-name {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text);
    }

    /* Emojis favoritos */
    .emoji-favorites {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 16px;
    }

    .emoji-fav-slot {
      width: 50px;
      height: 50px;
      border: 2px dashed var(--cream-dark);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      cursor: pointer;
      transition: all 0.2s;
      background: var(--white);
    }

    .emoji-fav-slot:hover {
      border-color: var(--sage-light);
    }

    .emoji-fav-slot.filled {
      border-style: solid;
      border-color: var(--sage-light);
    }

    .emoji-picker {
      padding: 16px;
      background: var(--cream);
      border-radius: var(--radius-md);
    }

    .emoji-picker-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-light);
      margin-bottom: 12px;
    }

    .emoji-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .emoji-btn {
      width: 38px;
      height: 38px;
      border: none;
      background: var(--white);
      border-radius: var(--radius-sm);
      font-size: 1.2rem;
      cursor: pointer;
      transition: all 0.15s;
    }

    .emoji-btn:hover {
      background: var(--sage-light);
      transform: scale(1.15);
    }

    /* Iconos del menÃº */
    .menu-icons-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .menu-icon-item {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 12px 16px;
      background: var(--cream);
      border-radius: var(--radius-md);
    }

    .menu-icon-current {
      width: 40px;
      height: 40px;
      background: var(--white);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.3rem;
      cursor: pointer;
      transition: all 0.2s;
      border: 2px solid transparent;
    }

    .menu-icon-current:hover {
      border-color: var(--sage-light);
    }

    .menu-icon-label {
      flex: 1;
      font-weight: 600;
      font-size: 0.95rem;
    }

    .menu-icon-options {
      display: none;
      flex-wrap: wrap;
      gap: 6px;
    }

    .menu-icon-options.visible {
      display: flex;
    }

    .menu-icon-option {
      width: 36px;
      height: 36px;
      border: none;
      background: var(--white);
      border-radius: var(--radius-sm);
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.15s;
    }

    .menu-icon-option:hover {
      background: var(--sage-light);
    }

    /* Botones de acciÃ³n */
    .actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
      margin-top: 24px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 12px 24px;
      border-radius: var(--radius-md);
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: all 0.2s;
      border: none;
      text-decoration: none;
    }

    .btn-ghost {
      background: transparent;
      color: var(--text-light);
      border: 1px solid var(--cream-dark);
    }

    .btn-ghost:hover {
      background: var(--cream);
      color: var(--text);
    }

    .btn-primary {
      background: var(--sage);
      color: var(--white);
    }

    .btn-primary:hover {
      background: var(--sage-dark);
    }

    /* Nota informativa */
    .info-note {
      display: flex;
      gap: 12px;
      padding: 16px;
      background: rgba(122, 158, 126, 0.1);
      border-radius: var(--radius-md);
      border-left: 3px solid var(--sage);
      margin-top: 16px;
    }

    .info-note-icon {
      font-size: 1.2rem;
    }

    .info-note-text {
      font-size: 0.9rem;
      color: var(--text-light);
      line-height: 1.5;
    }

    /* Toast de confirmaciÃ³n */
    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%) translateY(100px);
      background: var(--sage-dark);
      color: var(--white);
      padding: 14px 28px;
      border-radius: var(--radius-md);
      font-weight: 600;
      box-shadow: var(--shadow-medium);
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .toast.visible {
      transform: translateX(-50%) translateY(0);
      opacity: 1;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="header">
    <div class="header-left">
      <a href="cgi.html" class="back-btn">
        â† Volver
      </a>
      <h1 class="page-title">âš™ï¸ ConfiguraciÃ³n</h1>
    </div>
  </header>

  <main class="container">

    <!-- Avatar -->
    <section class="section">
      <div class="section-header">
        <div class="section-icon">ğŸ‘¤</div>
        <div>
          <div class="section-title">Tu avatar</div>
          <div class="section-subtitle">Elige cÃ³mo te ven los demÃ¡s</div>
        </div>
      </div>
      <div class="section-body">
        <div class="avatar-options">
          <div class="avatar-option active" data-type="inicial" onclick="selectAvatarType('inicial')">
            <div class="avatar-preview inicial" id="preview-inicial">F</div>
            <span class="avatar-label">Inicial</span>
          </div>
          <div class="avatar-option" data-type="emoji" onclick="selectAvatarType('emoji')">
            <div class="avatar-preview emoji" id="preview-emoji">ğŸ˜Š</div>
            <span class="avatar-label">Emoji</span>
          </div>
          <div class="avatar-option" data-type="foto" onclick="selectAvatarType('foto')">
            <div class="avatar-preview foto" id="preview-foto">ğŸ“·</div>
            <span class="avatar-label">Foto</span>
          </div>
        </div>

        <!-- Selector de emoji para avatar -->
        <div class="emoji-avatar-selector" id="emoji-avatar-selector">
          <div class="emoji-avatar-grid">
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ˜Š')">ğŸ˜Š</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ˜')">ğŸ˜</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ¤“')">ğŸ¤“</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ˜„')">ğŸ˜„</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ¥°')">ğŸ¥°</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ¤—')">ğŸ¤—</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ˜‡')">ğŸ˜‡</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ§‘')">ğŸ§‘</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ‘¨')">ğŸ‘¨</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ‘©')">ğŸ‘©</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ‘´')">ğŸ‘´</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ‘µ')">ğŸ‘µ</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ§”')">ğŸ§”</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ‘±')">ğŸ‘±</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ¦¸')">ğŸ¦¸</button>
            <button class="emoji-avatar-btn" onclick="selectAvatarEmoji('ğŸ§™')">ğŸ§™</button>
          </div>
        </div>

        <!-- Upload de foto -->
        <div class="foto-upload" id="foto-upload">
          <label class="foto-upload-area" for="foto-input">
            <div class="foto-upload-icon">ğŸ“¤</div>
            <div class="foto-upload-text">Haz clic para subir una foto</div>
          </label>
          <input type="file" id="foto-input" accept="image/*" style="display: none;" onchange="handleFotoUpload(event)">
        </div>
      </div>
    </section>

    <!-- Paleta de colores -->
    <section class="section">
      <div class="section-header">
        <div class="section-icon">ğŸ¨</div>
        <div>
          <div class="section-title">Paleta de colores</div>
          <div class="section-subtitle">Personaliza el aspecto de tu consola</div>
        </div>
      </div>
      <div class="section-body">
        <div class="color-themes">
          <div class="color-theme active" data-theme="sage" onclick="selectTheme('sage')">
            <div class="color-preview">
              <div class="color-dot" style="background: #7A9E7E;"></div>
              <div class="color-dot" style="background: #FDF8F3;"></div>
              <div class="color-dot" style="background: #C17757;"></div>
            </div>
            <div class="color-theme-name">Sage (defecto)</div>
          </div>
          <div class="color-theme" data-theme="ocean" onclick="selectTheme('ocean')">
            <div class="color-preview">
              <div class="color-dot" style="background: #4A90A4;"></div>
              <div class="color-dot" style="background: #F5F9FA;"></div>
              <div class="color-dot" style="background: #E8A87C;"></div>
            </div>
            <div class="color-theme-name">OcÃ©ano</div>
          </div>
          <div class="color-theme" data-theme="lavender" onclick="selectTheme('lavender')">
            <div class="color-preview">
              <div class="color-dot" style="background: #9B8AA5;"></div>
              <div class="color-dot" style="background: #FAF8FC;"></div>
              <div class="color-dot" style="background: #D4A373;"></div>
            </div>
            <div class="color-theme-name">Lavanda</div>
          </div>
          <div class="color-theme" data-theme="sunset" onclick="selectTheme('sunset')">
            <div class="color-preview">
              <div class="color-dot" style="background: #E07A5F;"></div>
              <div class="color-dot" style="background: #FFF8F0;"></div>
              <div class="color-dot" style="background: #81B29A;"></div>
            </div>
            <div class="color-theme-name">Atardecer</div>
          </div>
          <div class="color-theme" data-theme="earth" onclick="selectTheme('earth')">
            <div class="color-preview">
              <div class="color-dot" style="background: #8B7355;"></div>
              <div class="color-dot" style="background: #F9F6F2;"></div>
              <div class="color-dot" style="background: #6B8E6B;"></div>
            </div>
            <div class="color-theme-name">Tierra</div>
          </div>
          <div class="color-theme" data-theme="night" onclick="selectTheme('night')">
            <div class="color-preview">
              <div class="color-dot" style="background: #2C3E50;"></div>
              <div class="color-dot" style="background: #ECF0F1;"></div>
              <div class="color-dot" style="background: #E74C3C;"></div>
            </div>
            <div class="color-theme-name">Noche</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Emojis favoritos -->
    <section class="section">
      <div class="section-header">
        <div class="section-icon">â­</div>
        <div>
          <div class="section-title">Emojis favoritos</div>
          <div class="section-subtitle">Acceso rÃ¡pido en mensajes y comentarios</div>
        </div>
      </div>
      <div class="section-body">
        <div class="emoji-favorites">
          <div class="emoji-fav-slot filled" data-slot="0" onclick="openEmojiPicker(0)">ğŸ‘</div>
          <div class="emoji-fav-slot filled" data-slot="1" onclick="openEmojiPicker(1)">â¤ï¸</div>
          <div class="emoji-fav-slot filled" data-slot="2" onclick="openEmojiPicker(2)">ğŸ˜‚</div>
          <div class="emoji-fav-slot filled" data-slot="3" onclick="openEmojiPicker(3)">ğŸ‰</div>
          <div class="emoji-fav-slot" data-slot="4" onclick="openEmojiPicker(4)">+</div>
          <div class="emoji-fav-slot" data-slot="5" onclick="openEmojiPicker(5)">+</div>
        </div>
        <div class="emoji-picker">
          <div class="emoji-picker-title">Toca para aÃ±adir o cambiar:</div>
          <div class="emoji-grid">
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ‘')">ğŸ‘</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ‘')">ğŸ‘</button>
            <button class="emoji-btn" onclick="selectFavEmoji('â¤ï¸')">â¤ï¸</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ’š')">ğŸ’š</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ˜‚')">ğŸ˜‚</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ˜Š')">ğŸ˜Š</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ¥°')">ğŸ¥°</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ˜¢')">ğŸ˜¢</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ‰')">ğŸ‰</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ‚')">ğŸ‚</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ ')">ğŸ </button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸŒ³')">ğŸŒ³</button>
            <button class="emoji-btn" onclick="selectFavEmoji('â˜€ï¸')">â˜€ï¸</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸŒ™')">ğŸŒ™</button>
            <button class="emoji-btn" onclick="selectFavEmoji('âœ…')">âœ…</button>
            <button class="emoji-btn" onclick="selectFavEmoji('â­')">â­</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ”¥')">ğŸ”¥</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ’ª')">ğŸ’ª</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ™')">ğŸ™</button>
            <button class="emoji-btn" onclick="selectFavEmoji('ğŸ¤”')">ğŸ¤”</button>
          </div>
        </div>
      </div>
    </section>

    <!-- Iconos del menÃº -->
    <section class="section">
      <div class="section-header">
        <div class="section-icon">ğŸ“±</div>
        <div>
          <div class="section-title">Iconos del menÃº</div>
          <div class="section-subtitle">Cambia los iconos de tus secciones favoritas</div>
        </div>
      </div>
      <div class="section-body">
        <div class="menu-icons-list">
          <div class="menu-icon-item">
            <div class="menu-icon-current" onclick="toggleIconOptions(this)">ğŸ </div>
            <span class="menu-icon-label">Lo ComÃºn</span>
            <div class="menu-icon-options">
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ ')">ğŸ </button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ¡')">ğŸ¡</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ˜ï¸')">ğŸ˜ï¸</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ›ï¸')">ğŸ›ï¸</button>
            </div>
          </div>
          <div class="menu-icon-item">
            <div class="menu-icon-current" onclick="toggleIconOptions(this)">ğŸ“œ</div>
            <span class="menu-icon-label">Legado</span>
            <div class="menu-icon-options">
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ“œ')">ğŸ“œ</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ“–')">ğŸ“–</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸº')">ğŸº</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸŒ³')">ğŸŒ³</button>
            </div>
          </div>
          <div class="menu-icon-item">
            <div class="menu-icon-current" onclick="toggleIconOptions(this)">ğŸš€</div>
            <span class="menu-icon-label">ActivaciÃ³n</span>
            <div class="menu-icon-options">
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸš€')">ğŸš€</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'âš¡')">âš¡</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ¯')">ğŸ¯</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸª')">ğŸª</button>
            </div>
          </div>
          <div class="menu-icon-item">
            <div class="menu-icon-current" onclick="toggleIconOptions(this)">ğŸ§ </div>
            <span class="menu-icon-label">Cerebro</span>
            <div class="menu-icon-options">
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ§ ')">ğŸ§ </button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ’¡')">ğŸ’¡</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'ğŸ“Š')">ğŸ“Š</button>
              <button class="menu-icon-option" onclick="selectMenuIcon(this, 'âš™ï¸')">âš™ï¸</button>
            </div>
          </div>
        </div>

        <div class="info-note">
          <div class="info-note-icon">â„¹ï¸</div>
          <div class="info-note-text">
            Estos cambios solo afectan a <strong>tu experiencia</strong>. No modifican permisos, datos ni cÃ³mo ven FAMILYNK los demÃ¡s miembros de tu familia.
          </div>
        </div>
      </div>
    </section>

    <!-- Acciones -->
    <div class="actions">
      <button class="btn btn-ghost" onclick="resetDefaults()">Restaurar defecto</button>
      <button class="btn btn-primary" onclick="saveConfig()">ğŸ’¾ Guardar cambios</button>
    </div>

  </main>

  <!-- Toast -->
  <div class="toast" id="toast">âœ… Cambios guardados</div>

  <script>
    // Estado de configuraciÃ³n
    let config = {
      avatarType: 'inicial',
      avatarEmoji: 'ğŸ˜Š',
      avatarFoto: null,
      theme: 'sage',
      favoriteEmojis: ['ğŸ‘', 'â¤ï¸', 'ğŸ˜‚', 'ğŸ‰', null, null],
      menuIcons: {
        comun: 'ğŸ ',
        legado: 'ğŸ“œ',
        activacion: 'ğŸš€',
        cerebro: 'ğŸ§ '
      }
    };

    let currentEmojiSlot = null;

    // Cargar config guardada
    function loadConfig() {
      const saved = localStorage.getItem('familynk_config');
      if (saved) {
        config = { ...config, ...JSON.parse(saved) };
        applyConfig();
      }
    }

    function applyConfig() {
      // Avatar
      selectAvatarType(config.avatarType, false);
      if (config.avatarType === 'emoji') {
        document.getElementById('preview-emoji').textContent = config.avatarEmoji;
      }

      // Theme
      document.querySelectorAll('.color-theme').forEach(t => t.classList.remove('active'));
      document.querySelector(`[data-theme="${config.theme}"]`)?.classList.add('active');

      // Emojis favoritos
      config.favoriteEmojis.forEach((emoji, i) => {
        const slot = document.querySelector(`[data-slot="${i}"]`);
        if (slot) {
          slot.textContent = emoji || '+';
          slot.classList.toggle('filled', !!emoji);
        }
      });

      // Iconos menÃº
      const menuItems = document.querySelectorAll('.menu-icon-item');
      const keys = ['comun', 'legado', 'activacion', 'cerebro'];
      menuItems.forEach((item, i) => {
        const icon = item.querySelector('.menu-icon-current');
        if (icon && config.menuIcons[keys[i]]) {
          icon.textContent = config.menuIcons[keys[i]];
        }
      });
    }

    // Avatar
    function selectAvatarType(type, animate = true) {
      config.avatarType = type;
      
      document.querySelectorAll('.avatar-option').forEach(opt => {
        opt.classList.toggle('active', opt.dataset.type === type);
      });

      document.getElementById('emoji-avatar-selector').classList.toggle('visible', type === 'emoji');
      document.getElementById('foto-upload').classList.toggle('visible', type === 'foto');
    }

    function selectAvatarEmoji(emoji) {
      config.avatarEmoji = emoji;
      document.getElementById('preview-emoji').textContent = emoji;
      
      document.querySelectorAll('.emoji-avatar-btn').forEach(btn => {
        btn.classList.toggle('selected', btn.textContent === emoji);
      });
    }

    function handleFotoUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          config.avatarFoto = e.target.result;
          const preview = document.getElementById('preview-foto');
          preview.innerHTML = `<img src="${e.target.result}" alt="Avatar">`;
        };
        reader.readAsDataURL(file);
      }
    }

    // Tema
    function selectTheme(theme) {
      config.theme = theme;
      document.querySelectorAll('.color-theme').forEach(t => {
        t.classList.toggle('active', t.dataset.theme === theme);
      });
    }

    // Emojis favoritos
    function openEmojiPicker(slot) {
      currentEmojiSlot = slot;
      document.querySelectorAll('.emoji-fav-slot').forEach((s, i) => {
        s.style.outline = i === slot ? '2px solid var(--sage)' : 'none';
      });
    }

    function selectFavEmoji(emoji) {
      if (currentEmojiSlot !== null) {
        config.favoriteEmojis[currentEmojiSlot] = emoji;
        const slot = document.querySelector(`[data-slot="${currentEmojiSlot}"]`);
        slot.textContent = emoji;
        slot.classList.add('filled');
        slot.style.outline = 'none';
        currentEmojiSlot = null;
      }
    }

    // Iconos menÃº
    function toggleIconOptions(element) {
      const options = element.parentElement.querySelector('.menu-icon-options');
      document.querySelectorAll('.menu-icon-options').forEach(opt => {
        if (opt !== options) opt.classList.remove('visible');
      });
      options.classList.toggle('visible');
    }

    function selectMenuIcon(btn, icon) {
      const item = btn.closest('.menu-icon-item');
      const current = item.querySelector('.menu-icon-current');
      current.textContent = icon;
      
      const index = Array.from(document.querySelectorAll('.menu-icon-item')).indexOf(item);
      const keys = ['comun', 'legado', 'activacion', 'cerebro'];
      config.menuIcons[keys[index]] = icon;
      
      item.querySelector('.menu-icon-options').classList.remove('visible');
    }

    // Guardar
    function saveConfig() {
      localStorage.setItem('familynk_config', JSON.stringify(config));
      showToast('âœ… Cambios guardados');
    }

    // Restaurar
    function resetDefaults() {
      if (confirm('Â¿Restaurar toda la configuraciÃ³n a valores por defecto?')) {
        localStorage.removeItem('familynk_config');
        config = {
          avatarType: 'inicial',
          avatarEmoji: 'ğŸ˜Š',
          avatarFoto: null,
          theme: 'sage',
          favoriteEmojis: ['ğŸ‘', 'â¤ï¸', 'ğŸ˜‚', 'ğŸ‰', null, null],
          menuIcons: {
            comun: 'ğŸ ',
            legado: 'ğŸ“œ',
            activacion: 'ğŸš€',
            cerebro: 'ğŸ§ '
          }
        };
        applyConfig();
        showToast('ğŸ”„ ConfiguraciÃ³n restaurada');
      }
    }

    // Toast
    function showToast(message) {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.classList.add('visible');
      setTimeout(() => toast.classList.remove('visible'), 2500);
    }

    // Cerrar selectores al hacer clic fuera
    document.addEventListener('click', (e) => {
      if (!e.target.closest('.menu-icon-item')) {
        document.querySelectorAll('.menu-icon-options').forEach(opt => {
          opt.classList.remove('visible');
        });
      }
    });

    // Inicializar
    loadConfig();
  </script>

</body>
</html>
